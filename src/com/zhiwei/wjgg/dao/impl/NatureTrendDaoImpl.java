/** * *************************************************** * Copyright (C), NingBo ZhiWeiReach info. Co., Ltd. * ***************************************************** *  * */package com.zhiwei.wjgg.dao.impl;import java.util.List;import org.springframework.data.mongodb.core.query.Criteria;import org.springframework.data.mongodb.core.query.Query;import org.springframework.data.mongodb.core.query.Update;import org.springframework.stereotype.Component;import com.mongodb.WriteResult;import com.zhiwei.wjgg.dao.NatureTrendDao;import com.zhiwei.wjgg.exception.ZhiWeiException;import com.zhiwei.wjgg.model.EventTrend;import com.zhiwei.wjgg.model.NatureTrend;/** * @author cwt * @date 2016-02-29 */@Componentpublic class NatureTrendDaoImpl extends GeneralDaoImpl implements        NatureTrendDao{    @Override    public NatureTrend insert(NatureTrend ob) throws ZhiWeiException    {        try        {            ob.setId((ob.getEventId() + ob.getType()).replace(" ", "_"));            mongoTemp.insert(ob);        } catch (Exception e)        {            e.printStackTrace();        }        return ob;    }    public List<NatureTrend> insert(List<NatureTrend> list)            throws ZhiWeiException    {        try        {            for (NatureTrend ob : list)            {                ob.setId((ob.getEventId() + ob.getType()).replace(" ", "_"));                mongoTemp.insert(ob);            }        } catch (Exception e)        {            e.printStackTrace();        }        return list;    }    @Override    public NatureTrend findOne(String id) throws ZhiWeiException    {        NatureTrend ob;        try        {            ob = mongoTemp.findOne(new Query(Criteria.where("_id").is(id)),                    NatureTrend.class);            return ob;        } catch (Exception e)        {            e.printStackTrace();        }        return null;    }    @Override    public NatureTrend findOne(NatureTrend ob) throws ZhiWeiException    {        NatureTrend ob1;        try        {            Query query = new Query();            query.addCriteria(Criteria.where("type").is(ob.getType()));            query.addCriteria(Criteria.where("eventId").is(ob.getEventId()));            ob1 = mongoTemp.findOne(query, NatureTrend.class);            return ob1;        } catch (Exception e)        {            e.printStackTrace();        }        return null;    }    @Override    public List<NatureTrend> findAll() throws ZhiWeiException    {        List<NatureTrend> list = null;        try        {            list = mongoTemp.find(null, NatureTrend.class);        } catch (Exception e)        {            e.printStackTrace();        }        return list;    }    @Override    public long findCont() throws ZhiWeiException    {        return mongoTemp.count(null, NatureTrend.class);    }    @Override    public boolean removeOneById(String id) throws ZhiWeiException    {        boolean result = false;        try        {            mongoTemp.remove(new Query(Criteria.where("_id").is(id)),                    NatureTrend.class);            result = true;        } catch (Exception e)        {            e.printStackTrace();        }        return result;    }    @Override    public boolean removeAll() throws ZhiWeiException    {        // TODO Auto-generated method stub        return false;    }    @Override    public boolean findAndModify(NatureTrend ob) throws ZhiWeiException    {        boolean result = false;        WriteResult res;        try        {            Query query = new Query();            query.addCriteria(Criteria.where("_id").is(ob.getId()));            Update update = new Update();            update.set("time_num", ob.getTime_num());            res = mongoTemp.upsert(query, update, NatureTrend.class);            result = true;        } catch (Exception e)        {            e.printStackTrace();        }        return result;    }    @Override    public NatureTrend findByEventIdInTime(String eventId, String type)    {        NatureTrend ob = null;        try        {            Query query = new Query();            query.addCriteria(Criteria.where("_id").is(eventId+type));            ob = mongoTemp.findOne(query, NatureTrend.class);        } catch (Exception e)        {            e.printStackTrace();        }        return ob;    }    @Override    public boolean deleteByEventId(String eventId)    {        boolean result = false;        try        {            mongoTemp.remove(new Query(Criteria.where("eventId").is(eventId)),                    NatureTrend.class);            result = true;        } catch (Exception e)        {            e.printStackTrace();        }        return result;    }}